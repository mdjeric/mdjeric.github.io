<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Functions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Functions</h1>

</div>


<hr />
<p>These are some of the R functions written over time to make some things easier to do. If you find them useful, that’s great! Please let me know. :) I do not believe there are packages or functions that do this—if there are, please let me know! And these would end-up on a pile “I struggled, solved it—oh, wait, there’s a package for that”.</p>
<hr />
<div id="mean-on-at-least" class="section level3">
<h3>Mean on at least</h3>
<p>Does the same thing as SPSS <code>mean.#</code>. Calculates mean of a case if more than n values are not NA, otherwise returns NA. Handy for making indexes of several variables when you can specify to calculate it if e.g. more than 75% or 90% of values are present in each case. See it <a href="f_mean.html">here</a>.</p>
</div>
<div id="recoding-gss-religion" class="section level3">
<h3>Recoding GSS religion</h3>
<p>Function recodes religion from three variables: <code>relig</code>, <code>denom</code>, and <code>other</code> according to classification provided by Sherkat and Lehman in <a href="https://iranianredneck.wordpress.com/2016/11/29/why-reltrad-sucks-contesting-the-measure-of-american-religion/" target="_blank">“After The Resurrection: The Field of the Sociology of Religion in the United States”</a>. Main goal is to address three issues:</p>
<ol style="list-style-type: decimal">
<li>Recode whole family of religion variables in GSS (<code>other</code> is for respondent coded with letter codes, and for others—father, mother, friends—with just punch codes).</li>
<li>Recode no matter how GSS data is imported to R (two ways for SPSS files).</li>
<li>Relatively easily change how are groups coded.</li>
<li>Recode religion successfully.</li>
</ol>
<p>At this point, only 3 and 4 work well. Beside huge number of categories (cca 200 for <code>other</code>), main problem is that punch codes from GSS codebook do not correspond to factor values once data is imported (some codes and blocks of numbers are just skipped). You can see more <a href="f_relig.html">here</a>.</p>
</div>
<div id="improving-regression-ceofficient-plots" class="section level3">
<h3>Improving regression ceofficient plots</h3>
<p>Following great advice for data visualization in Kieran Healy’s <a href="http://socviz.co/" target="_blank">Data Visualization</a>, when plotting marginal effects (or coefficients) one should order them in their size. However, in case of large number of categorical variables, with several levels, it can be quite tricky to read. Once several models are included it becomes a hell. This function prepares data frame with coefficients for plotting with facets. Effectively, it orders whole variables according to the number of models in which they are, within those groups, it then orders variables according to their average value, and in the end, orders levels (sample is included). It’s not complicated, but it uses several for loops and there is probably way to do some of these things easier. It’s <a href="f_reg_cp.html">here</a>.</p>
</div>
<div id="scaling-thousands-and-millions" class="section level3">
<h3>Scaling thousands and millions</h3>
<p>Nothing special, but nice. Using <code>scale</code> package, in <code>ggplot2</code> numbers on axis start to have K or M, depending on their size (3000 to 3K, 7000000 to 7M). See it <a href="f_scale.html">here</a>.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
